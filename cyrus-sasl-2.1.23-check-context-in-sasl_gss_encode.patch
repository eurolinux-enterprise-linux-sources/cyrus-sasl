diff --git a/plugins/gssapi.c b/plugins/gssapi.c
index 37f2e29..af3d86f 100644
--- a/plugins/gssapi.c
+++ b/plugins/gssapi.c
@@ -328,6 +328,7 @@ sasl_gss_encode(void *context, const struct iovec *invec, unsigned numiov,
     int ret;
     struct buffer_info *inblob, bufinfo;
     
+    if(!context) return SASL_BADPARAM;
     if(!output) return SASL_BADPARAM;
     
     if(numiov > 1) {
