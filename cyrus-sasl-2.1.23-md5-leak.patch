diff --git a/plugins/digestmd5.c b/plugins/digestmd5.c
index ea883cd..687c06b 100644
--- a/plugins/digestmd5.c
+++ b/plugins/digestmd5.c
@@ -3039,6 +3039,7 @@ static int make_client_response(context_t *text,
     
     
     resplen = 0;
+    if (text->out_buf) params->utils->free(text->out_buf);
     text->out_buf = NULL;
     text->out_buf_len = 0;
     if (add_to_challenge(params->utils,
